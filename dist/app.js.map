{"version":3,"sources":["../js/app.js"],"names":["app","constants","chatbot","wrluLib","start","res","code","payload","data","type","sender","getSender","buttons","elements","action","params","fields","orderId","kind","setTimeout","fbService","sendTextMessage","handleDefault","then","dres","button","title","url","push","card","image_url","subtitle","err","console","log"],"mappings":";;AAGA;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;AACA;;;;;;AAKA,IAAMA,MAAM,wBAAZ;;AAEA,wBAASA,GAAT,EAAcC,iBAAd;AACA,qBAAOD,GAAP;;AAGA,oBAAKA,GAAL;;AAEA,IAAIE,UAAU,IAAIC,iBAAJ,CAAYH,GAAZ,EAAiBC,iBAAjB,CAAd;;AAEAC,QAAQE,KAAR,CAAcJ,GAAd,EAAkB,UAACK,GAAD,EAAS;AAC1B,KAAGA,IAAIC,IAAJ,KAAa,GAAhB,EAAoB;AACnB;;AAEA,MAAGD,IAAIE,OAAP,EAAe;AACd,OAAG;AACF,QAAIC,OAAOH,IAAIE,OAAf;AACA,QAAGC,KAAKC,IAAL,IAAa,QAAb,IAAyBD,KAAKC,IAAL,IAAa,UAAtC,IAAoDD,KAAKC,IAAL,IAAa,YAApE,EAAiF;AAChF;AACA,SAAIC,SAASR,QAAQS,SAAR,EAAb;AACA,SAAIC,UAAU,EAAd;AAAA,SAAkBC,WAAW,EAA7B;;AAEA,SAAGL,KAAKC,IAAL,IAAa,QAAhB,EAAyB;AACxB,cAAOD,KAAKM,MAAZ;AACC,YAAK,cAAL;AAAoB;AACnB;AACA;AACA,aAAGN,KAAKO,MAAL,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2BT,KAAKO,MAAL,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2BC,IAAtD,CAAH,EAA+D;AAC9DC,qBAAY,YACZ;AACCjB,mBAAQkB,SAAR,CAAkBC,eAAlB,CAAkCX,MAAlC,EAAyC,qFAAzC;AACA,WAHD,EAGG,IAHH;AAIA;AACD;AACA;AAXF;AAaA;AACDR,aAAQoB,aAAR,CAAsBjB,GAAtB,EAA2BkB,IAA3B,CAAgC,UAACC,IAAD,EAAU;AACzC,UAAGA,IAAH,EAAQ;AACPtB,eAAQoB,aAAR,CAAsBE,IAAtB;AACA;AACD,MAJD;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAIC,SAAS;AACZhB,YAAM,SADM;AAEZiB,aAAO,sBAFK;AAGZC,WAAK;AAHO,MAAb;AAKAf,aAAQgB,IAAR,CAAaH,MAAb;;AAEA,SAAII,OAAO;AACVH,aAAO,WADG;AAEVI,iBAAU,+EAFA;AAGVC,gBAAU,mBAHA;AAIVnB,eAASA;AAJC,MAAX;;AAOAC,cAASe,IAAT,CAAcC,IAAd;;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAED,IA/DD,CA+DC,OAAMG,GAAN,EAAU;AACVC,YAAQC,GAAR,kDAA2DF,GAA3D;AACA;AACD;AACD;AACD,CAzED","file":"app.js","sourcesContent":["\n\n\nimport { constants } from './libs/config'\nimport express from 'express'\n\nimport wrluLib from './wrlu-lib/wrLuLib'\n\nimport init from './libs/init'\nimport settings from './libs/settings'\nimport router from './routes/index'\n\n\n\n\nconst app = express();\n\nsettings(app, constants);\nrouter(app);\n\n\ninit(app);\n\nlet chatbot = new wrluLib(app, constants);\n\nchatbot.start(app,(res) => {\n\tif(res.code === 200){\n\t\t// console.log(`JSON RESPONSE ChatbotLib: \\n ${JSON.stringify(res)}`);\n\t\t\n\t\tif(res.payload){\n\t\t\ttry{\n\t\t\t\tlet data = res.payload;\n\t\t\t\tif(data.type == 'action' || data.type == 'messages' || data.type == 'quickReply'){\n\t\t\t\t\t// let defaultres = chatbot.handleDefault(res);\n\t\t\t\t\tlet sender = chatbot.getSender();\n\t\t\t\t\tlet buttons = [], elements = [];\n\n\t\t\t\t\tif(data.type == 'action'){\n\t\t\t\t\t\tswitch(data.action){\n\t\t\t\t\t\t\tcase 'order.status':{\n\t\t\t\t\t\t\t\t// console.log('Parametro de Orden: ');\n\t\t\t\t\t\t\t\t// console.log(data.params.fields.orderId[data.params.fields.orderId.kind]);\n\t\t\t\t\t\t\t\tif(data.params.fields.orderId[data.params.fields.orderId.kind]){\n\t\t\t\t\t\t\t\t\tsetTimeout( () => \n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tchatbot.fbService.sendTextMessage(sender,'Tu orden se encuentra en camino, con el nÃºmero de orden puedes darle seguimiento :)');\n\t\t\t\t\t\t\t\t\t}, 3000);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tchatbot.handleDefault(res).then((dres) => {\n\t\t\t\t\t\tif(dres){\n\t\t\t\t\t\t\tchatbot.handleDefault(dres);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// if(defaultres){\n\t\t\t\t\t// \tdefaultres.then((x) => {\n\t\t\t\t\t// \t\tconsole.log('Default res');\n\t\t\t\t\t// \t\tconsole.log(JSON.stringify(defaultres));\n\t\t\t\t\t// \t\tconsole.log('Promise resolved');\n\t\t\t\t\t// \t\tconsole.log(JSON.stringify(x));\n\t\t\t\t\t// \t\tchatbot.handleDefault(x);\n\t\t\t\t\t// \t});\n\t\t\t\t\t// }\n\n\t\t\t\t\tlet button = {\n\t\t\t\t\t\ttype: 'web_url',\n\t\t\t\t\t\ttitle: 'See something great!',\n\t\t\t\t\t\turl: 'https://s3-eu-west-1.amazonaws.com/barkibu-blog/blog+images/diarrea-en-cachorros-recien-nacidos-causas-y-tratamiento/diarreacachorros2.jpg?'\n\t\t\t\t\t};\n\t\t\t\t\tbuttons.push(button);\n\n\t\t\t\t\tlet card = {\n\t\t\t\t\t\ttitle: 'Blue card',\n\t\t\t\t\t\timage_url:'https://ucl.suzuki.co.uk/static/images/unity/suzukiucl/new/models/celerio.png',\n\t\t\t\t\t\tsubtitle: 'Some card for you',\n\t\t\t\t\t\tbuttons: buttons\n\t\t\t\t\t};\n\n\t\t\t\t\telements.push(card);\n\n\t\t\t\t\t// setTimeout(() => {\n\t\t\t\t\t// \t// chatbot.fbService.sendTextMessage(sender,'Hi, i got a image for u');\n\t\t\t\t\t// \t// chatbot.fbService.sendFileMessage(sender,'https://ucl.suzuki.co.uk/static/images/unity/suzukiucl/new/models/celerio.png','image');\n\t\t\t\t\t// \t// chatbot.fbService.sendButtonMessage(sender,'Some cool Buttons',buttons);\n\t\t\t\t\t// \t// chatbot.fbService.sendGenericMessage(sender, elements);\n\t\t\t\t\t// },100);\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t}catch(err){\n\t\t\t\tconsole.log(`An error ocurred on chatbot process. Error: ${err}`);\n\t\t\t}\n\t\t}\n\t}\n});\n"]}